<!DOCTYPE html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>sankey</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<meta charset="utf-8">
<title>Resume Sankey</title>
<style>

#chart {
  height: 500px;
}

.node rect {
  cursor: move;
  fill-opacity: .9;
  shape-rendering: crispEdges;
}

.node text {
  pointer-events: none;
  text-shadow: 0 1px 0 #fff;
  font:12px/1.5 Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;
}

.link {
  fill: none;
  stroke: #000;
  stroke-opacity: .2;
}

.link:hover {
  stroke-opacity: .5;
}

.chart {
      shape-rendering: crispEdges;
    }

.mini text {
      font: 9px sans-serif; 
    }

.main text {
      font: 12px sans-serif;  
    }

.miniItem0 {
      fill: darksalmon;
      stroke-width: 6;  
    }

.miniItem1 {
      fill: darkolivegreen;
      fill-opacity: .7;
      stroke-width: 6;  
    }

.miniItem2 {
      fill: slategray;
      fill-opacity: .7;
      stroke-width: 6;  
    }

</style>
<body>
 
<h2>Resume Flow Chart</h2>
<p id="chart">
  <script type="text/javascript">
    //data
    var lanes = ["Year"],
      laneLength = lanes.length,
      items = [{"lane": 0, "id": "2007", "start": 0, "end": 3},
          {"lane": 0, "id": "2008", "start": 3, "end": 14},
          {"lane": 0, "id": "2009", "start": 14, "end": 23},
          {"lane": 0, "id": "2010", "start": 23, "end": 35},
          {"lane": 0, "id": "2011", "start": 35, "end": 50},
          {"lane": 0, "id": "2012", "start": 50, "end": 63},
          {"lane": 0, "id": "2013", "start": 63, "end": 75},
          {"lane": 0, "id": "2014", "start": 75, "end": 95},
          {"lane": 0, "id": "2015", "start": 95, "end": 100}]
      timeBegin = 0,
      timeEnd = 100;
    </script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.3.11/d3.min.js"></script>
<script src="/datavis/assets/sankey/sankey.js"></script>
<script>


var margin = {top: 1, right: 40, bottom: 6, left: 1},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var formatNumber = d3.format(",.0f"),
    format = function(d) { return formatNumber(d/100) + "%"; },
    color = d3.scale.category20();

var svg = d3.select("#chart").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var sankey = d3.sankey()
    .nodeWidth(15)
    .nodePadding(10)
    .size([width, height]);

var m = [20, 15, 15, 120], //top right bottom left
    miniWidth = laneLength * 12 + 50,
    mainWidth = width - miniWidth - 50;

var y = d3.scale.linear()
        .domain([timeBegin, timeEnd])
        .range([height, 0]);
var x = d3.scale.linear()
        .domain([0, laneLength])
        .range([0, miniWidth]);



var path = sankey.link();

d3.json("/datavis/assets/sankey/resume.json", function(energy) {

  sankey
      .nodes(energy.nodes)
      .links(energy.links)
      .layout(32);

  var link = svg.append("g").selectAll(".link")
      .data(energy.links)
    .enter().append("path")
      .attr("class", "link")
      .attr("d", path)
      .style("stroke-width", function(d) { return Math.max(1, d.dy); })
      .sort(function(a, b) { return b.dy - a.dy; });

  link.append("title")
      .text(function(d) { return d.source.name + " â†’ " + d.target.name + "\n" + format(d.value); });

  var node = svg.append("g").selectAll(".node")
      .data(energy.nodes)
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
    .call(d3.behavior.drag()
      .origin(function(d) { return d; })
      .on("dragstart", function() { this.parentNode.appendChild(this); })
      .on("drag", dragmove));

  node.append("rect")
      .attr("height", function(d) { return d.dy; })
      .attr("width", sankey.nodeWidth())
      .style("fill", function(d) { return d.color = color(d.weightedTarget); })
      .style("stroke", function(d) { return d3.rgb(d.color).darker(2); })
    .append("title")
      .text(function(d) { return d.name + "\n" + format(d.value); });

  node.append("text")
      .attr("x", -6)
      .attr("y", function(d) { return d.dy / 2; })
      .attr("dy", ".35em")
      .attr("text-anchor", "end")
      .attr("transform", null)
      .text(function(d) { return d.name; })
    .filter(function(d) { return d.x < width / 2; })
      .attr("x", 6 + sankey.nodeWidth())
      .attr("text-anchor", "start");

  function dragmove(d) {
    d3.select(this).attr("transform", "translate(" + d.x + "," + (d.y = Math.max(0, Math.min(height - d.dy, d3.event.y))) + ")");
    sankey.relayout();
    link.attr("d", path);
  }


});


var mini = svg.append("g")
          .attr("transform", "translate(" + 0 + "," + 0 + ")")
          .attr("height", height)
          .attr("width", width)
          .attr("class", "mini");

// mini.append("g").selectAll("miniItems")
//       .data(items)
//       .enter().append("rect")
//       .attr("class", function(d) {return "miniItem" + d.lane;})
//       .attr("y", function(d) {return y(d.end);})
//       .attr("x", function(d) {return x(d.lane)+920;})
//       .attr("height", function(d) {return y(d.end-d.start);})
//       .attr("width", 10);

    //mini labels
mini.append("g").selectAll(".miniLabels")
      .data(items)
      .enter().append("text")
      .text(function(d) {return d.id;})
      .attr("y", function(d) {return y((d.start+d.end)/2);})
      .attr("x", function(d) {return x(d.lane)+920;})
      .attr("dx", ".5ex");

</script>
</p>
<pre><code> $ skill       ------------->       analytical method      --------->      software implementation     --------->     project</pre></code></p>

 <p>This chart aligns my skill sets as they have progressed over time.  It moves from my most general skills to examples of those skills throughout my career and school projects.  On the left, I've outline major categories of skills.  These line up with statistical and machine learning techniques.  These methods can be performed across a variety of programs.  I've linked the stats/ml method to the program(s) I used during analysis.  Finally, the analytical method and the implementation line up with the variety of projects I've completed over the years.  These are listed chronologically.    
